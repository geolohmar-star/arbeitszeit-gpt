<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>{{ betreff }}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 11pt;
            color: #000;
            margin: 0;
            padding: 0;
        }
        .seite {
            padding: 2cm 2.5cm;
        }
        h1 {
            font-size: 14pt;
            margin-bottom: 4px;
        }
        .betreff {
            background: #f0f0f0;
            border: 1px solid #ccc;
            padding: 8px 12px;
            font-family: monospace;
            font-size: 11pt;
            margin-bottom: 24px;
            word-break: break-all;
        }
        table.daten {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table.daten td {
            padding: 5px 8px;
            border-bottom: 1px solid #eee;
            vertical-align: top;
        }
        table.daten td.label {
            color: #555;
            width: 200px;
            white-space: nowrap;
        }
        .abschnitt {
            margin-bottom: 20px;
        }
        .abschnitt-titel {
            font-size: 11pt;
            font-weight: bold;
            border-bottom: 2px solid #1a4d2e;
            padding-bottom: 3px;
            margin-bottom: 10px;
            color: #1a4d2e;
        }
        .genehmigung-box {
            border: 1px solid #999;
            padding: 16px;
            margin-top: 32px;
        }
        .genehmigung-zeile {
            display: inline-block;
            width: 45%;
            border-bottom: 1px solid #000;
            margin-bottom: 24px;
            padding-bottom: 2px;
        }
        .placeholder {
            color: #999;
            font-style: italic;
        }
        .badge-platzhalter {
            font-size: 9pt;
            color: #999;
            font-style: italic;
        }
    </style>
</head>
<body>
<div class="seite">

    <h1>Änderung Zeiterfassung manuell</h1>
    <p style="color:#555; margin-bottom:16px;">Antrag auf manuelle Korrektur der Zeiterfassung</p>

    <!-- Betreff -->
    <div class="abschnitt">
        <div class="abschnitt-titel">Betreff / Aktenzeichen</div>
        <div class="betreff">{{ betreff }}</div>
    </div>

    <!-- Antragsdaten -->
    <div class="abschnitt">
        <div class="abschnitt-titel">Antragsdaten</div>
        <table class="daten">
            <tr>
                <td class="label">Antragsdatum</td>
                <td>{{ antrag.erstellt_am|date:"d.m.Y H:i" }} Uhr</td>
            </tr>
            <tr>
                <td class="label">Name</td>
                <td>{{ antrag.antragsteller.vorname }} {{ antrag.antragsteller.nachname }}</td>
            </tr>
            <tr>
                <td class="label">Abteilung</td>
                <td>{{ antrag.antragsteller.abteilung }}</td>
            </tr>
            <tr>
                <td class="label">Telefon intern</td>
                <td class="placeholder">folgt (neue Mitarbeiterverwaltung)</td>
            </tr>
            <tr>
                <td class="label">Personalnummer</td>
                <td>{{ antrag.antragsteller.personalnummer }}</td>
            </tr>
            <tr>
                <td class="label">Wochenarbeitszeit</td>
                <td>
                    {% if vereinbarung and vereinbarung.wochenstunden %}
                        {{ vereinbarung.wochenstunden }} Std.
                    {% else %}
                        <span class="placeholder">keine Vereinbarung gefunden</span>
                    {% endif %}
                </td>
            </tr>
        </table>
    </div>

    <!-- Art der Änderung -->
    {% if antrag.art %}
    <div class="abschnitt">
        <div class="abschnitt-titel">Art der Änderung</div>
        <table class="daten">
            <tr>
                <td class="label">Art</td>
                <td>{{ antrag.get_art_display }}</td>
            </tr>
            {% if antrag.art == "beruflich_unterwegs" or antrag.art == "b_taste" %}
                {% if antrag.kommen_datum %}
                <tr>
                    <td class="label">Kommen – Datum</td>
                    <td>{{ antrag.kommen_datum|date:"d.m.Y" }}</td>
                </tr>
                <tr>
                    <td class="label">Kommen – Terminal</td>
                    <td>{{ antrag.get_kommen_terminal_display }}</td>
                </tr>
                {% endif %}
                {% if antrag.gehen_datum %}
                <tr>
                    <td class="label">Gehen – Datum</td>
                    <td>{{ antrag.gehen_datum|date:"d.m.Y" }}</td>
                </tr>
                <tr>
                    <td class="label">Gehen – Terminal</td>
                    <td>{{ antrag.get_gehen_terminal_display }}</td>
                </tr>
                {% endif %}
            {% elif antrag.art == "k_taste" %}
                <tr>
                    <td class="label">K-Taste – Datum</td>
                    <td>{{ antrag.ktaste_datum|date:"d.m.Y" }}</td>
                </tr>
                <tr>
                    <td class="label">K-Taste – Terminal</td>
                    <td>{{ antrag.get_ktaste_terminal_display }}</td>
                </tr>
            {% endif %}
        </table>
    </div>
    {% endif %}

    <!-- Zeiten -->
    {% if antrag.zeiten_daten %}
    <div class="abschnitt">
        <div class="abschnitt-titel">Zeiten</div>
        <table class="daten">
            <tr>
                <td class="label" style="font-weight:bold">Datum</td>
                <td style="font-weight:bold">Kommen</td>
                <td style="font-weight:bold">Pause Beginn</td>
                <td style="font-weight:bold">Pause Ende</td>
                <td style="font-weight:bold">Gehen</td>
            </tr>
            {% for zeile in antrag.zeiten_daten %}
            <tr>
                <td class="label">{{ zeile.datum }}</td>
                <td>{{ zeile.kommen|default:"–" }}</td>
                <td>{{ zeile.pause_gehen|default:"–" }}</td>
                <td>{{ zeile.pause_kommen|default:"–" }}</td>
                <td>{{ zeile.gehen|default:"–" }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    <!-- Samstagsarbeit -->
    {% if antrag.samstag_art %}
    <div class="abschnitt">
        <div class="abschnitt-titel">Samstagsarbeit</div>
        <table class="daten">
            {% if antrag.samstag_datum %}
            <tr>
                <td class="label">Datum</td>
                <td>{{ antrag.samstag_datum|date:"d.m.Y" }}</td>
            </tr>
            {% endif %}
            <tr>
                <td class="label">Art</td>
                <td>{{ antrag.get_samstag_art_display }}</td>
            </tr>
            {% if antrag.samstag_art == "ausserhalb" %}
            <tr>
                <td class="label">Anfangszeit</td>
                <td>{{ antrag.samstag_beginn }}</td>
            </tr>
            <tr>
                <td class="label">Endzeit</td>
                <td>{{ antrag.samstag_ende }}</td>
            </tr>
            {% elif antrag.samstag_art == "dauerfreigabe" %}
            <tr>
                <td class="label">Vereinbarungsnummer</td>
                <td>{{ antrag.samstag_vereinbarungsnummer }}</td>
            </tr>
            <tr>
                <td class="label">Gültig ab</td>
                <td>{{ antrag.samstag_freigabe_ab|date:"d.m.Y" }}</td>
            </tr>
            <tr>
                <td class="label">Gültig bis</td>
                <td>{{ antrag.samstag_freigabe_bis|date:"d.m.Y" }}</td>
            </tr>
            {% endif %}
        </table>
    </div>
    {% endif %}

    <!-- Tagestausch -->
    {% if antrag.tausch_daten %}
    <div class="abschnitt">
        <div class="abschnitt-titel">Tagestausch</div>
        <table class="daten">
            <tr>
                <td class="label" style="font-weight:bold">Arbeitstag (wird FREI)</td>
                <td style="font-weight:bold">Neuer Arbeitstag</td>
            </tr>
            {% for zeile in antrag.tausch_daten %}
            <tr>
                <td class="label">{{ zeile.von_datum }}</td>
                <td>{{ zeile.zu_datum }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    <!-- Genehmigung -->
    <div class="genehmigung-box">
        <div class="abschnitt-titel">Genehmigung <span class="badge-platzhalter">(folgt aus Genehmigungsworkflow)</span></div>
        <table style="width:100%">
            <tr>
                <td>
                    Genehmigt Vorgesetzter:<br>
                    <div class="genehmigung-zeile">&nbsp;</div>
                </td>
                <td>
                    Datum der Genehmigung:<br>
                    <div class="genehmigung-zeile">&nbsp;</div>
                </td>
            </tr>
        </table>
    </div>

</div>
</body>
</html>
