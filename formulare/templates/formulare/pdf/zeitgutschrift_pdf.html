<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Zeitgutschrift - {{ antrag.get_betreff }}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 11pt;
            margin: 2cm;
        }
        h1 {
            font-size: 18pt;
            margin-bottom: 0.5cm;
        }
        h2 {
            font-size: 14pt;
            margin-top: 1cm;
            margin-bottom: 0.3cm;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1cm;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 0.3cm;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        .info-table td:first-child {
            width: 35%;
            font-weight: bold;
        }
        .text-right {
            text-align: right;
        }
        .highlight {
            background-color: #fff3cd;
        }
        .footer {
            margin-top: 2cm;
            font-size: 9pt;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>Zeitgutschrift</h1>

    <p><strong>Betreff:</strong> {{ antrag.get_betreff }}</p>

    <h2>Antragsteller</h2>
    <table class="info-table">
        <tr>
            <td>Name:</td>
            <td>{{ antrag.antragsteller.vorname }} {{ antrag.antragsteller.nachname }}</td>
        </tr>
        <tr>
            <td>Personalnummer:</td>
            <td>{{ antrag.antragsteller.personalnummer }}</td>
        </tr>
        <tr>
            <td>Erstellt am:</td>
            <td>{{ antrag.erstellt_am|date:"d.m.Y H:i" }} Uhr</td>
        </tr>
        <tr>
            <td>Status:</td>
            <td>{{ antrag.get_status_display }}</td>
        </tr>
    </table>

    <h2>Art der Zeitgutschrift</h2>
    <p>{{ antrag.get_art_display }}</p>

    <!-- Haertefall / Ehrenamt: Zeitraumliste -->
    {% if antrag.art == "haertefall" or antrag.art == "ehrenamt" %}
    {% if antrag.zeilen_daten %}
    <h2>Zeitraum(e)</h2>
    <table>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Von (Zeit)</th>
                <th>Bis (Zeit)</th>
            </tr>
        </thead>
        <tbody>
            {% for zeile in antrag.zeilen_daten %}
            <tr>
                <td>{{ zeile.datum }}</td>
                <td>{{ zeile.von_zeit }}</td>
                <td>{{ zeile.bis_zeit }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% endif %}

    <!-- Fortbildung: Berechnungstabelle -->
    {% if antrag.art == "fortbildung" and antrag.fortbildung_berechnung %}
    <h2>Fortbildungsdetails</h2>
    <table class="info-table">
        <tr>
            <td>Typ:</td>
            <td>{{ antrag.get_fortbildung_typ_display }}</td>
        </tr>
        <tr>
            <td>Wochenstunden regulaer:</td>
            <td>{{ antrag.fortbildung_wochenstunden_regulaer }} h</td>
        </tr>
        <tr>
            <td>Zeitraum:</td>
            <td>{{ antrag.fortbildung_von_datum|date:"d.m.Y" }} - {{ antrag.fortbildung_bis_datum|date:"d.m.Y" }}</td>
        </tr>
        <tr>
            <td>Massnahmen-Nr:</td>
            <td>{{ antrag.fortbildung_massnahme_nr }}</td>
        </tr>
    </table>

    <h2>Berechnungsergebnis</h2>
    <table>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Wochentag</th>
                <th class="text-right">Fortbildung Soll (h)</th>
                <th class="text-right">Vereinbarung Soll (h)</th>
            </tr>
        </thead>
        <tbody>
            {% for zeile in antrag.fortbildung_berechnung.zeilen %}
            <tr>
                <td>{{ zeile.datum }}</td>
                <td>{{ zeile.wochentag }}</td>
                <td class="text-right">{{ zeile.fortbildung_soll }}</td>
                <td class="text-right">{{ zeile.vereinbarung_soll }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr style="background-color: #f0f0f0;">
                <td colspan="2"><strong>Summe</strong></td>
                <td class="text-right"><strong>{{ antrag.fortbildung_berechnung.summe_fortbildung }} h</strong></td>
                <td class="text-right"><strong>{{ antrag.fortbildung_berechnung.summe_vereinbarung }} h</strong></td>
            </tr>
            <tr class="highlight">
                <td colspan="2"><strong>Differenz</strong></td>
                <td colspan="2" class="text-right">
                    <strong>{{ antrag.fortbildung_berechnung.differenz }} h</strong>
                </td>
            </tr>
        </tfoot>
    </table>
    {% endif %}

    <!-- Erkrankung eines Angehoerigen / Kind / Betreuungsperson -->
    {% if antrag.art == "erkrankung_angehoerige" or antrag.art == "erkrankung_kind" or antrag.art == "erkrankung_betreuung" %}
    <h2>Details zur Erkrankung</h2>
    <table class="info-table">
        <tr>
            <td>Datum der Erkrankung:</td>
            <td>{{ antrag.erkrankung_datum|date:"d.m.Y" }}</td>
        </tr>
        <tr>
            <td>Art der Arbeitszeit:</td>
            <td>
                {% if antrag.erkrankung_typ == "regulaer" %}
                    Regelmaessige Arbeitszeit
                {% elif antrag.erkrankung_typ == "individuell" %}
                    Individuelle Vereinbarung
                {% else %}
                    {{ antrag.erkrankung_typ }}
                {% endif %}
            </td>
        </tr>
        {% if antrag.erkrankung_typ == "regulaer" and antrag.erkrankung_wochenstunden %}
        <tr>
            <td>Wochenstunden (regelmaessig):</td>
            <td>{{ antrag.erkrankung_wochenstunden }} h</td>
        </tr>
        <tr>
            <td>Berechnungsformel:</td>
            <td>(Wochenstunden &#247; 5) &#247; 2</td>
        </tr>
        {% elif antrag.erkrankung_typ == "individuell" and antrag.erkrankung_tagesstunden %}
        <tr>
            <td>Arbeitsstunden am betreffenden Tag:</td>
            <td>{{ antrag.erkrankung_tagesstunden }} h</td>
        </tr>
        <tr>
            <td>Berechnungsformel:</td>
            <td>Tagesstunden &#247; 2</td>
        </tr>
        {% endif %}
        {% if antrag.erkrankung_gutschrift_stunden %}
        <tr class="highlight">
            <td><strong>Zeitgutschrift:</strong></td>
            <td><strong>{{ antrag.erkrankung_gutschrift_hmin }}</strong></td>
        </tr>
        {% endif %}
    </table>
    {% endif %}

    <!-- Mehrarbeit Ab-/Buchung / Ueberstunden / Rufbereitschaft -->
    {% if antrag.art == "mehrarbeit" or antrag.art == "mehrarbeit_buchung" or antrag.art == "ueberstunden_buchung" or antrag.art == "rufbereitschaft_buchung" %}
    <h2>Buchungsdetails</h2>
    <table class="info-table">
        <tr>
            <td>Buchungszeitraum:</td>
            <td>{{ antrag.buchungsmonat_name }} {{ antrag.mehrarbeit_buchungsjahr }}</td>
        </tr>
        <tr class="highlight">
            <td><strong>Stunden:</strong></td>
            <td><strong>{{ antrag.mehrarbeit_stunden }} h {{ antrag.mehrarbeit_minuten }} min</strong></td>
        </tr>
        {% if antrag.mehrarbeit_begruendung %}
        <tr>
            <td>Erlaeuterung:</td>
            <td>{{ antrag.mehrarbeit_begruendung }}</td>
        </tr>
        {% endif %}
    </table>
    {% endif %}

    <!-- Sonstige Anliegen -->
    {% if antrag.art == "sonstige" %}
    <h2>Angaben</h2>
    <table class="info-table">
        <tr>
            <td>Buchungszeitraum:</td>
            <td>{{ antrag.buchungsmonat_name }} {{ antrag.mehrarbeit_buchungsjahr }}</td>
        </tr>
        <tr class="highlight">
            <td><strong>Betrag:</strong></td>
            <td>
                <strong>
                {% if antrag.sonstige_vorzeichen == "+" %}
                    + {{ antrag.mehrarbeit_stunden }} h {{ antrag.mehrarbeit_minuten }} min (Zeitgutschrift)
                {% elif antrag.sonstige_vorzeichen == "-" %}
                    &minus; {{ antrag.mehrarbeit_stunden }} h {{ antrag.mehrarbeit_minuten }} min (Zeitabbuchung)
                {% endif %}
                </strong>
            </td>
        </tr>
        {% if antrag.mehrarbeit_begruendung %}
        <tr>
            <td>Erlaeuterung:</td>
            <td>{{ antrag.mehrarbeit_begruendung }}</td>
        </tr>
        {% endif %}
    </table>
    {% endif %}

    <!-- Hochgeladene Belege -->
    {% if antrag.belege.count > 0 %}
    <h2>Hochgeladene Belege</h2>
    <ul>
        {% for beleg in antrag.belege.all %}
        <li>{{ beleg.dateiname_original }} ({{ beleg.dateigroesse_formatiert }})</li>
        {% endfor %}
    </ul>
    {% endif %}

    <div class="footer">
        <p>Dieses Dokument wurde automatisch generiert am {{ now|date:"d.m.Y H:i" }} Uhr.</p>
    </div>
</body>
</html>
