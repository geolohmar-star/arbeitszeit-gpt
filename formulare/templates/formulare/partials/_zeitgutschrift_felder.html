{% if art == "haertefall" or art == "ehrenamt" %}
<!-- Haertefall / Ehrenamt: Dynamische Zeilen -->
<div class="mt-3">
    <h6 class="mb-2">Zeitraum(e)</h6>

    <div id="zeilen-container">
        <!-- Erste Zeile automatisch anzeigen -->
        {% include "formulare/partials/_zeitgutschrift_zeile.html" %}
    </div>

    <button type="button"
            class="btn btn-sm btn-outline-primary mt-2"
            hx-get="{% url 'formulare:neue_zeitgutschrift_zeile' %}"
            hx-target="#zeilen-container"
            hx-swap="beforeend">
        + Zeile hinzufuegen
    </button>
</div>

<!-- Belege-Upload (optional) -->
<div class="mt-4">
    <h6 class="mb-2">Belege (optional)</h6>
    <p class="text-muted small mb-2">
        PDF, JPG oder PNG, max. 10 MB pro Datei
    </p>
    <input type="file" name="belege" class="form-control" multiple accept=".pdf,.jpg,.jpeg,.png">
    {% if form.belege.errors %}
    <div class="text-danger small mt-1">{{ form.belege.errors.0 }}</div>
    {% endif %}
</div>

{% elif art == "fortbildung" %}
<!-- Fortbildung: Schritt 1 – Bestaetigung individuelle Vereinbarung -->
<div class="mt-3">
    <p class="fw-semibold mb-2">Haben Sie eine individuelle Arbeitszeitvereinbarung?</p>

    <div class="d-flex gap-2">
        <button type="button"
                class="btn {% if individ == 'ja' %}btn-primary{% else %}btn-outline-primary{% endif %}"
                hx-get="{% url 'formulare:zeitgutschrift_felder' %}?art=fortbildung&individ_bestaetigung=ja"
                hx-target="#felder-container"
                hx-swap="innerHTML">
            Ja
        </button>
        <button type="button"
                class="btn {% if individ == 'nein' %}btn-secondary{% else %}btn-outline-secondary{% endif %}"
                hx-get="{% url 'formulare:zeitgutschrift_felder' %}?art=fortbildung&individ_bestaetigung=nein"
                hx-target="#felder-container"
                hx-swap="innerHTML">
            Nein
        </button>
    </div>

    {% if individ == "ja" %}
    <!-- Hidden Field: fortbildung_aktiv = True fuer Formular-Submit -->
    <input type="hidden" name="fortbildung_aktiv" value="on">

    <!-- Schritt 2 – Felder fuer Fortbildung -->
    <div class="mt-4" id="fortbildung-felder">

        <!-- Typ -->
        <div class="mb-3">
            <label class="form-label fw-semibold">Typ</label>
            {% for choice in form.fortbildung_typ %}
            <div class="form-check">
                {{ choice.tag }}
                <label class="form-check-label" for="{{ choice.id_for_label }}">
                    {{ choice.choice_label }}
                </label>
            </div>
            {% endfor %}
            {% if form.fortbildung_typ.errors %}
            <div class="text-danger small mt-1">{{ form.fortbildung_typ.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Wochenstunden regulaer -->
        <div class="mb-3">
            <label class="form-label fw-semibold" for="{{ form.fortbildung_wochenstunden_regulaer.id_for_label }}">
                Wochenstunden regulaer
            </label>
            {{ form.fortbildung_wochenstunden_regulaer }}
            {% if form.fortbildung_wochenstunden_regulaer.errors %}
            <div class="text-danger small mt-1">{{ form.fortbildung_wochenstunden_regulaer.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Von Datum -->
        <div class="mb-3">
            <label class="form-label fw-semibold" for="{{ form.fortbildung_von_datum.id_for_label }}">
                Von Datum
            </label>
            {{ form.fortbildung_von_datum }}
            {% if form.fortbildung_von_datum.errors %}
            <div class="text-danger small mt-1">{{ form.fortbildung_von_datum.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Bis Datum -->
        <div class="mb-3">
            <label class="form-label fw-semibold" for="{{ form.fortbildung_bis_datum.id_for_label }}">
                Bis Datum
            </label>
            {{ form.fortbildung_bis_datum }}
            {% if form.fortbildung_bis_datum.errors %}
            <div class="text-danger small mt-1">{{ form.fortbildung_bis_datum.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Massnahmen-Nr -->
        <div class="mb-3">
            <label class="form-label fw-semibold" for="{{ form.fortbildung_massnahme_nr.id_for_label }}">
                Massnahmen-Nr
            </label>
            {{ form.fortbildung_massnahme_nr }}
            {% if form.fortbildung_massnahme_nr.errors %}
            <div class="text-danger small mt-1">{{ form.fortbildung_massnahme_nr.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Berechnung ausloesen -->
        <div class="mb-3">
            <button type="button"
                    class="btn btn-outline-info"
                    hx-post="{% url 'formulare:zeitgutschrift_fortbildung_berechnen' %}"
                    hx-include="[name='fortbildung_von_datum'], [name='fortbildung_bis_datum'], [name='fortbildung_wochenstunden_regulaer']"
                    hx-target="#berechnung-container"
                    hx-swap="innerHTML">
                Stunden berechnen
            </button>
            <small class="text-muted ms-2">Von-Datum, Bis-Datum und Wochenstunden ausfullen, dann berechnen</small>
        </div>

        <!-- Ergebnis der Berechnung -->
        <div id="berechnung-container"></div>

        <!-- Belege-Upload (optional) -->
        <div class="mt-4">
            <h6 class="mb-2">Belege (optional)</h6>
            <p class="text-muted small mb-2">
                PDF, JPG oder PNG, max. 10 MB pro Datei
            </p>
            <input type="file" name="belege" class="form-control" multiple accept=".pdf,.jpg,.jpeg,.png">
            {% if form.belege.errors %}
            <div class="text-danger small mt-1">{{ form.belege.errors.0 }}</div>
            {% endif %}
        </div>
    </div>

    {% elif individ == "nein" %}
    <div class="alert alert-info mt-3">
        Diese Zeitgutschrift gilt nur fuer Mitarbeiter mit individueller Arbeitszeitvereinbarung.
    </div>
    {% endif %}

</div>

{% endif %}
