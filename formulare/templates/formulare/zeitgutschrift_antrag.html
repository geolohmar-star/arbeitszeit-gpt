{% extends "base.html" %}

{% block title %}Zeitgutschrift{% endblock %}

{% block content %}
<div class="container mt-4" style="max-width: 880px;">

    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'formulare:dashboard' %}">Formulare</a>
            </li>
            <li class="breadcrumb-item active">Zeitgutschrift</li>
        </ol>
    </nav>

    <h2 class="mb-1">Zeitgutschrift</h2>
    <p class="text-muted mb-4">
        Beantragen Sie Zeitgutschriften f√ºr Haertefaelle, Ehrenamter oder ganztaegige Fortbildungen.
    </p>

    {% if form.errors or form.non_field_errors %}
    <div class="alert alert-danger">
        {% if form.non_field_errors %}
        <ul class="mb-0">
            {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% if form.errors %}
        <p class="mb-0"><strong>Bitte Formular pruefen.</strong></p>
        {% endif %}
    </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Art-Auswahl -->
        <div class="card mb-3">
            <div class="card-header fw-bold">Art der Zeitgutschrift</div>
            <div class="card-body">
                <div class="mb-3">
                    {% for choice in form.art %}
                    <div class="form-check">
                        {{ choice.tag }}
                        <label class="form-check-label" for="{{ choice.id_for_label }}">
                            {{ choice.choice_label }}
                        </label>
                    </div>
                    {% endfor %}
                    {% if form.art.errors %}
                    <div class="text-danger small mt-1">{{ form.art.errors.0 }}</div>
                    {% endif %}
                </div>

                <!-- HTMX: Felder nachladen -->
                <div id="felder-container"
                     hx-get="{% url 'formulare:zeitgutschrift_felder' %}"
                     hx-trigger="change from:[name='art']"
                     hx-include="[name='art']:checked"
                     hx-swap="innerHTML">
                    <!-- Wird per HTMX geladen -->
                </div>
            </div>
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">
                Antrag einreichen
            </button>
            <a href="{% url 'formulare:dashboard' %}" class="btn btn-outline-secondary">
                Abbrechen
            </a>
        </div>
    </form>
</div>
{% endblock %}
